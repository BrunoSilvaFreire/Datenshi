using Datenshi.Scripts.Entities;
using Datenshi.Scripts.Graphics.Colorization;
using Shiroi.FX.Utilities;
using UnityEngine;

namespace Datenshi.Scripts.Misc {
    public class InvulnerabilityTracker : MonoBehaviour {
        public LivingEntity Entity;
        private bool lastFrame;
        public float Duration;
        public Color Color = Color.white;

        private void Update() {
            var now = Entity.IsInvulnerable;
            if (lastFrame && !now) {
                Entity.ColorizableRenderer.ColorController.RegisterTimedService(Duration,
                    new ColorOverrideMeta(1, Color));
            }

            lastFrame = now;
        }
    }
}